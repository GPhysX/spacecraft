<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>RungeKutta.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>RungeKutta.h</h1><a href="RungeKutta_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 
00008 
00010 
00011 
00012 <span class="preprocessor">#ifndef RUNGEKUTTA_H</span>
00013 <span class="preprocessor"></span><span class="preprocessor">#define RUNGEKUTTA_H</span>
00014 <span class="preprocessor"></span>
00015 <span class="preprocessor">#include &lt;<a class="code" href="Matrix_8h.html">Matrix.h</a>&gt;</span>
00016 
00017 
<a name="l00042"></a><a class="code" href="RungeKutta_8h.html#a0">00042</a> <span class="keyword">inline</span> Matrix <a class="code" href="RungeKutta_8h.html#a0">RungeKuttaSolve</a>(Matrix (*odeFunc)(<span class="keywordtype">double</span> timeInput, <a class="code" href="Matrix_8h.html#a5">Vector</a> stateInput, Matrix constantsInput), <span class="keyword">const</span> <a class="code" href="Matrix_8h.html#a5">Vector</a> &amp;_initialConditions, <span class="keyword">const</span> Matrix &amp;_constants, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;_timeInitial, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;_timeFinal, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;_numSteps)
00043 {
00044         
00045         <span class="keywordtype">double</span> h = (_timeFinal - _timeInitial) / _numSteps;
00046         <span class="keywordtype">double</span> t = _timeInitial;
00047         <span class="keywordtype">int</span> numEqs = _initialConditions.getIndexCount();
00048         <a class="code" href="Matrix_8h.html#a5">Vector</a> inputs(numEqs); inputs = _initialConditions;
00049         <a class="code" href="Matrix_8h.html#a5">Vector</a> K1(numEqs);
00050         <a class="code" href="Matrix_8h.html#a5">Vector</a> K2(numEqs);
00051         <a class="code" href="Matrix_8h.html#a5">Vector</a> K3(numEqs);
00052         <a class="code" href="Matrix_8h.html#a5">Vector</a> K4(numEqs);
00053 
00054         Matrix output(_numSteps + 1, numEqs + 1);
00055 
00056         output(0,0) = _timeInitial;
00057         output(0,_(1,numEqs)) = ~_initialConditions;
00058 
00059         <a class="code" href="Matrix_8h.html#a5">Vector</a> temp(numEqs);
00060         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 1; ii &lt;= _numSteps; ++ii)
00061         {
00062             K1 = h * odeFunc(t, inputs, _constants);
00063             temp = inputs + K1 / 2.0;
00064             K2 = h * odeFunc(t + h/2, temp, _constants);
00065             temp = inputs + K2 / 2.0;
00066             K3 = h * odeFunc(t + h/2, temp, _constants);
00067             temp = inputs + K3;
00068             K4 = h * odeFunc(t + h, temp, _constants);
00069             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj &lt; numEqs; ++jj)
00070             {
00071                 inputs(jj) += (K1(jj)
00072                                  + 2.0 * K2(jj)
00073                                  + 2.0 * K3(jj)
00074                                  + K4(jj)) / 6.0;                       
00075             }
00076             t = _timeInitial + ii * h;
00077             output(ii,0) = t;
00078             output(ii,_(1,numEqs)) = ~inputs;   
00079         }
00080         <span class="keywordflow">return</span> output;
00081 }
00082 
00083 
00084 <span class="preprocessor">#endif RungeKutta</span>
</pre></div><hr><address style="align: right;"><small>Generated on Thu Feb 27 13:46:17 2003 for Spacecraft Simulation Framework by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
